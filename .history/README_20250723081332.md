# Host2 スクレイピングツール

Host2の店舗情報を自動で収集し、Excelファイルに出力するWebアプリケーションです。

## 機能

- ブラウザから簡単にスクレイピングを開始・停止
- キーワード検索による絞り込み機能
- スタッフ情報の取得（オプション）
- リアルタイムの進捗表示
- 取得したデータのExcelファイルダウンロード
- 美しいWebインターフェース

## 取得する情報

### 店舗情報
- 店舗名
- 店舗URL
- 電話番号
- 営業時間
- 定休日
- 初回料金

### スタッフ情報（オプション）
- スタッフ名
- 身長
- 画像URL
- 詳細情報

## セットアップ

### 1. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 2. アプリケーションの起動

```bash
python app.py
```

### 3. ブラウザでアクセス

ブラウザで `http://localhost:5000` にアクセスしてください。

## 使用方法

1. **設定**: 
   - 検索キーワードを入力（オプション）
   - スタッフ情報取得のチェックボックスを選択（オプション）
2. **スクレイピング開始**: 「スクレイピング開始」ボタンをクリック
3. **進捗確認**: 実行状況パネルでリアルタイムの進捗を確認
4. **停止**: 必要に応じて「スクレイピング停止」ボタンで停止
5. **ダウンロード**: 完了後、「ファイルをダウンロード」ボタンでExcelファイルを取得

### 検索キーワードについて
- 店舗URLに含まれるキーワードで絞り込みます
- 例: 「新宿」「渋谷」「池袋」など
- 空白の場合は全店舗を対象とします

### スタッフ情報について
- チェックすると各店舗のスタッフ情報も収集します
- 取得時間が長くなります
- Excelファイルは「店舗情報」と「スタッフ情報」の2つのシートに分けて保存されます

## ファイル構成

```
host2_scraper/
├── app.py              # Flaskアプリケーション
├── main.py             # 元のスクレイピングスクリプト
├── requirements.txt    # 依存関係
├── templates/
│   └── index.html      # Webインターフェース
└── README.md           # このファイル
```

## 注意事項

- スクレイピングはサイトへの負荷を考慮して1-2秒の間隔を設けています
- 大量のデータを取得する際は時間がかかる場合があります
- サイトの構造変更により動作しなくなる可能性があります

## トラブルシューティング

### アプリケーションが起動しない場合
- Python 3.7以上がインストールされているか確認
- 依存関係が正しくインストールされているか確認

### スクレイピングが失敗する場合
- インターネット接続を確認
- 対象サイトがアクセス可能か確認
- ファイアウォールの設定を確認

## ライセンス

このプロジェクトは教育目的で作成されています。使用する際は対象サイトの利用規約を遵守してください。 